# -*- coding: utf-8 -*-
"""EDA_smart_energy.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eTpA2NTHfY3ODf-RpAAmz0KclRhqTCnY

# **EDA for Smart Energy Dataset**
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from google.colab import files
uploaded = files.upload()

df = pd.read_csv('Energy_consumption.csv')
df.head()

df.info()
df.describe()

size = df.shape
print(size)
print(df.isnull().sum())

plt.figure(figsize=(14, 7))
sns.lineplot(x='Timestamp', y='EnergyConsumption', data=df)
plt.title('Energy Consumption Over Time')
plt.xlabel('Timestamp')
plt.ylabel('Energy Consumption')
plt.grid(True)
plt.tight_layout()
plt.show()

"""### Plot Explanation: Energy Consumption Over Time (Cell `6861d3e9`)

This line plot visualizes the 'EnergyConsumption' values against their respective 'Timestamp'. It shows the raw, unaggregated energy consumption data over the entire period captured by the dataset. This plot helps us observe overall trends, daily or weekly cycles, and any sudden spikes or drops in energy consumption as they occurred historically.
"""

df.plot(x = 'DayOfWeek', y = 'EnergyConsumption', kind = 'bar')
plt.xlabel("Day of the week")
plt.ylabel("Energy Consumption")
plt.title("Day of the week vs Energy Consumption")
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.show()

print(df['DayOfWeek'].unique())

daily_energy_consumption = df.groupby('DayOfWeek')['EnergyConsumption'].mean().reset_index()
day_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
daily_energy_consumption['DayOfWeek'] = pd.Categorical(daily_energy_consumption['DayOfWeek'], categories=day_order, ordered=True)
daily_energy_consumption = daily_energy_consumption.sort_values('DayOfWeek')

plt.figure(figsize=(10, 6))
sns.barplot(x='DayOfWeek', y='EnergyConsumption', data=daily_energy_consumption, palette='viridis')
plt.xlabel("Day of the week")
plt.ylabel("Average Energy Consumption")
plt.title("Average Energy Consumption by Day of the Week")
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.show()

highest_consumption_day = daily_energy_consumption.loc[daily_energy_consumption['EnergyConsumption'].idxmax()]
print(f"The day with the highest average energy consumption is {highest_consumption_day['DayOfWeek']} with an average of {highest_consumption_day['EnergyConsumption']:.2f}.")

"""### Plot Explanation: Average Energy Consumption by Day of the Week (Cell `fb83a1d6`)

This bar plot displays the average energy consumption for each day of the week. By grouping the data by 'DayOfWeek' and calculating the mean 'EnergyConsumption', we can clearly see which days typically have higher or lower energy usage. This helps in identifying weekly patterns and potential days for energy conservation efforts.

### Identify Outliers using Box Plots
"""

numerical_features = ['Temperature', 'Humidity', 'SquareFootage', 'Occupancy', 'RenewableEnergy', 'EnergyConsumption']

plt.figure(figsize=(15, 10))
for i, feature in enumerate(numerical_features):
    plt.subplot(2, 3, i + 1)  # Create a 2x3 grid of subplots
    sns.boxplot(y=df[feature])
    plt.title(f'Box Plot of {feature}')
    plt.ylabel(feature)
plt.tight_layout()
plt.show()

"""### Plot Explanation: Box Plots for Outlier Detection (Cell `3680d8a4`)

These box plots are generated for each numerical feature to visually identify potential outliers. The box represents the interquartile range (IQR), the line inside is the median, and the 'whiskers' extend to data points within 1.5 times the IQR. Any points plotted individually beyond the whiskers are considered outliers, indicating values that are unusually high or low compared to the rest of the data. This helps in understanding data quality and extreme observations.

## Analyze Correlations

Visualize the correlation matrix between numerical features in the dataset, particularly focusing on their correlation with 'EnergyConsumption'.
"""

numerical_cols = ['Temperature', 'Humidity', 'SquareFootage', 'Occupancy', 'RenewableEnergy', 'EnergyConsumption']
correlation_matrix = df[numerical_cols].corr()

plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title('Correlation Matrix of Numerical Features')
plt.show()

"""### Plot Explanation: Correlation Matrix of Numerical Features (Cell `4a30beaa`)

This heatmap shows the correlation coefficients between all pairs of numerical features in the dataset. The color intensity and annotated values indicate the strength and direction of the linear relationship between variables. A strong positive correlation (closer to 1) means that as one variable increases, the other tends to increase. This helps identify which numerical factors are most strongly associated with 'EnergyConsumption'.

## Examine Distributions of Numerical Features

Distribution plots (histograms or KDE plots) for key numerical columns like 'Temperature', 'Humidity', 'SquareFootage', 'RenewableEnergy', and 'EnergyConsumption' to understand their spread and central tendency.
"""

numerical_features_to_plot = ['Temperature', 'Humidity', 'SquareFootage', 'RenewableEnergy', 'EnergyConsumption']

for feature in numerical_features_to_plot:
    plt.figure(figsize=(8, 6))
    sns.histplot(data=df, x=feature, kde=True, bins=30, palette='viridis')
    plt.title(f'Distribution of {feature}')
    plt.xlabel(feature)
    plt.ylabel('Frequency')
    plt.show()

numerical_features_to_plot = ['Temperature', 'Humidity', 'SquareFootage', 'RenewableEnergy', 'EnergyConsumption']

for feature in numerical_features_to_plot:
    plt.figure(figsize=(8, 6))
    sns.histplot(data=df, x=feature, kde=True, bins=30)
    plt.title(f'Distribution of {feature}')
    plt.xlabel(feature)
    plt.ylabel('Frequency')
    plt.show()

"""### Plot Explanation: Distributions of Numerical Features (Cell `2062e563`)

These histogram and Kernel Density Estimate (KDE) plots illustrate the distribution of key numerical features ('Temperature', 'Humidity', 'SquareFootage', 'RenewableEnergy', 'EnergyConsumption'). Each plot shows how frequently different values occur within that feature's range, revealing its shape, central tendency, and spread. This helps us understand the typical values and variability of each factor.

## Investigate Impact of HVAC and Lighting Usage

Visualize the average 'EnergyConsumption' based on 'HVACUsage' and 'LightingUsage' categories using bar plots or box plots to see how these factors influence consumption.
"""

hvac_energy_consumption = df.groupby('HVACUsage')['EnergyConsumption'].mean().reset_index()
lighting_energy_consumption = df.groupby('LightingUsage')['EnergyConsumption'].mean().reset_index()

plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
sns.barplot(x='HVACUsage', y='EnergyConsumption', data=hvac_energy_consumption, palette='viridis')
plt.title('Average Energy Consumption by HVAC Usage')
plt.xlabel('HVAC Usage')
plt.ylabel('Average Energy Consumption')

plt.subplot(1, 2, 2)
sns.barplot(x='LightingUsage', y='EnergyConsumption', data=lighting_energy_consumption, palette='plasma')
plt.title('Average Energy Consumption by Lighting Usage')
plt.xlabel('Lighting Usage')
plt.ylabel('Average Energy Consumption')

plt.tight_layout()
plt.show()

hvac_energy_consumption = df.groupby('HVACUsage')['EnergyConsumption'].mean().reset_index()
lighting_energy_consumption = df.groupby('LightingUsage')['EnergyConsumption'].mean().reset_index()

plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
sns.barplot(x='HVACUsage', y='EnergyConsumption', data=hvac_energy_consumption)
plt.title('Average Energy Consumption by HVAC Usage')
plt.xlabel('HVAC Usage')
plt.ylabel('Average Energy Consumption')

plt.subplot(1, 2, 2)
sns.barplot(x='LightingUsage', y='EnergyConsumption', data=lighting_energy_consumption)
plt.title('Average Energy Consumption by Lighting Usage')
plt.xlabel('Lighting Usage')
plt.ylabel('Average Energy Consumption')

plt.tight_layout()
plt.show()

"""### Plot Explanation: Average Energy Consumption by HVAC and Lighting Usage

These two bar plots compare the average energy consumption based on the 'HVACUsage' and 'LightingUsage' categories ('On' vs 'Off'). They highlight the direct impact of these systems on overall energy usage, showing how much more or less energy is consumed when HVAC or lighting is active. This is crucial for identifying significant energy drivers.

## Compare Energy Consumption on Holidays
"""

holiday_energy_consumption = df.groupby('Holiday')['EnergyConsumption'].mean().reset_index()

plt.figure(figsize=(8, 6))
sns.barplot(x='Holiday', y='EnergyConsumption', data=holiday_energy_consumption)
plt.title('Average Energy Consumption by Holiday Status')
plt.xlabel('Holiday')
plt.ylabel('Average Energy Consumption')
plt.show()

"""### Plot Explanation: Average Energy Consumption by Holiday Status

This bar plot compares the average energy consumption on holidays versus non-holidays. It helps determine if there's a significant difference in energy usage patterns during special days, potentially due to altered occupancy or operational schedules. This can inform special energy management strategies for holiday periods.

## Analyze Hourly Energy Consumption Patterns
"""

df['Timestamp'] = pd.to_datetime(df['Timestamp'])
df['Hour'] = df['Timestamp'].dt.hour

hourly_energy_consumption = df.groupby('Hour')['EnergyConsumption'].mean().reset_index()

plt.figure(figsize=(12, 7))
sns.lineplot(x='Hour', y='EnergyConsumption', data=hourly_energy_consumption, marker='o')
plt.title('Average Energy Consumption by Hour of the Day')
plt.xlabel('Hour of the Day')
plt.ylabel('Average Energy Consumption')
plt.xticks(range(0, 24))
plt.grid(True)
plt.show()

df.head()

"""### Plot Explanation: Average Energy Consumption by Hour of the Day (Cell `9964533b`)

This line plot shows the average energy consumption for each hour of the day. It reveals the typical daily energy usage cycle, including peak consumption times and periods of lower demand. This hourly pattern is vital for optimizing energy schedules, implementing demand-side management, and understanding operational efficiency throughout a 24-hour cycle.

## Summary:

### Data Analysis Key Findings

*   **Correlations with Energy Consumption**: Temperature showed a strong positive correlation with EnergyConsumption (0.70). In contrast, Humidity, SquareFootage, Occupancy, and RenewableEnergy exhibited very low correlations with EnergyConsumption.
*   **Feature Distributions**: Numerical features such as Temperature, Humidity, SquareFootage, RenewableEnergy, and EnergyConsumption generally displayed fairly normal or uniform distributions.
*   **Impact of HVAC and Lighting Usage**: Average energy consumption is notably higher when HVAC is 'On' compared to 'Off'. Similarly, energy consumption is higher when Lighting is 'On' compared to 'Off', indicating a significant influence of both factors.
*   **Holiday Impact**: Average energy consumption is slightly higher on holidays compared to non-holidays.
*   **Hourly Patterns**: Energy consumption exhibits clear hourly patterns, with fluctuations throughout the day, including identifiable peak consumption times and periods of lower usage.

### Insights or Next Steps

*   To optimize energy consumption, strategies should primarily focus on managing HVAC and lighting usage, given their significant impact.
*   Further analysis of the specific peak hourly consumption times could inform targeted demand-side management and energy efficiency initiatives.
"""